# Course Review

This is a small back-end project for course and review related information in MongoDB. Use postman to test it.

## Technologies:

- TypeScript
- Mongoose
- Express.js
- jwt

## Models:

### User Model:

- \_id (Object ID): A distinctive identifier generated by MongoDB.
- username (string): The username of the user. This field holds a unique identifier for the user.
- email (string): The email address of the user. This field stores the user's email, ensuring it is unique.
- password (string): The password linked to the user's account, securely hashed. Strong password validation is checked. If the password doesn't match the requirements, custom message is sent as response explaining the requirements.
- role ('user' | 'admin'): The role of the user, which can be either 'user' or 'admin'. This field determines the user's level of access or permissions. The default role is set to 'user'.

### Course Model:

- \_id (Object ID): A distinctive identifier generated by MongoDB.
- title (String): A unique title of the course.
- instructor (String): The instructor of the course.
- categoryId (Object ID): A reference to the category collection.
- price (Number): The price of the course.
- tags(Array of Object): The "tags" field is an array of objects, each having a "name" (string) and "isDeleted" (boolean) property.
- startDate (String): The start date of the course.
- endDate (String): The end date of the course.
- language (String): The language in which the course is conducted.
- provider (String): The provider of the course.
- durationInWeeks (Integer): It is the duration of the course. It is automatically calculated in weeks.
- details (Object):
  - level (string): e.g., Beginner, Intermediate, Advanced.
  - description (string): Detailed description of the course
- createdBy (Object ID): A reference to the user collection.

### Category Model:

- \_id (Object ID): A distinctive identifier generated by MongoDB.
- name (String): A unique name of the category.
- createdBy (Object ID): A reference to the user collection.

### Review Model:

- \_id (Object ID): A distinctive identifier generated by MongoDB.
- courseId (Object ID): A reference to the course collection.
- rating (Number): Rating, which falls within the range of 1 to 5.
- review (String): The comment or review text provided by the user.
- createdBy (Object ID): A reference to the user collection.

## Validation:

- For validations of the input data, `zod` was used.

## Endpoints:

### 1.User Registration

- Route: `/api/auth/register`
- Method: POST

### 2.User Login

- Route: `/api/auth/login`
- Method: POST

### 3.Change Password

- Route: `/api/auth/change-password`
- Method: POST
- Request Headers:
  - Authorization: <JWT_TOKEN>

#### Password Change Rules:
- The system stores only the last 2 previous passwords with timestamps.
- During a password change attempt:
- The user cannot reuse any of the last 2 passwords or the current one.
- If the new password matches any of the previous 2 passwords or the current one, the password change fails.
- If the new password is unique and different from the current password, the password change is successful.

### 4.Create a Course (Only Admin can do this)

- Route: `/api/courses`
- Method: POST
- Request Headers:
  - Authorization: <ADMIN_JWT_TOKEN>

### 5.Get Paginated and Filtered Courses

- Route: `/api/courses`
- Method: GET

    ### Query Parameters for API Requests:

    When interacting with the API, you can utilize the following query parameters to customize and filter the results according to your preferences.

     - page: (Optional) Specifies the page number for paginated results. Default is 1. Example: ?page=2
 
     - limit: (Optional) Sets the number of items per page. Default is a predefined limit. Example: ?limit=10
 
     - sortBy: (Optional) Specifies the field by which the results should be sorted. Only applicable to the following fields: title, price, startDate, endDate, language, durationInWeeks. Example: ?sortBy=startDate
 
     - sortOrder: (Optional) Determines the sorting order, either 'asc' (ascending) or 'desc' (descending). Example: ?sortOrder=desc
 
     - minPrice, maxPrice: (Optional) Filters results by a price range. Example: ?minPrice=20.00&maxPrice=50.00
 
     - tags: (Optional) Filters results by the name of a specific tag. Example: ?tags=Programming
 
     - startDate, endDate: (Optional) Filters results by a date range. Example: ?startDate=2023-01-01&endDate=2023-12-31
 
     - language: (Optional) Filters results by the language of the course. Example: ?language=English
 
     - provider: (Optional) Filters results by the course provider. Example: ?provider=Tech Academy
 
     - durationInWeeks: (Optional) Filters results by the duration of the course in weeks. Example: ?durationInWeeks=8
 
     - level: (Optional) Filters results by the difficulty level of the course. Example: ?level=Intermediate

### 6.Create a Category (Only Admin can do this)

- Route: `/api/categories`
- Method: POST
- Request Headers:
  - Authorization: <ADMIN_JWT_TOKEN>

### 7.Get All Categories

- Route: `/api/categories`
- Method: GET

### 8.Create a Review (Only the user can do this)

- Route: `/api/reviews`
- Method: POST
- Request Headers:
  - Authorization: <USER_JWT_TOKEN>

### 9.Update a Course (Only Admin can do this)

- Route: `/api/courses/:courseId`
- Method: PUT
- Request Headers:
  - Authorization: <ADMIN_JWT_TOKEN>

### 10.Get Course by ID with Reviews

- Route: `/api/courses/:courseId/reviews`
- Method: GET

### 11.Get the Best Course Based on Average Review (Rating)

- Route: `/api/course/best`
- Method: GET

## Dependencies

- cors: ^2.8.5
- dotenv: ^16.3.1
- express: ^4.18.2
- mongoose: ^8.0.1
- http-status": ^1.7.3,
- jsonwebtoken": ^9.0.2
- lint-staged": ^15.1.0,
- zod: ^3.22.4

## Dev Dependencies

- @types/bcrypt: ^5.0.2
- @types/cors: ^2.8.16
- @types/express: ^4.17.21
- @typescript-eslint/eslint-plugin: ^6.11.0
- @typescript-eslint/parser: ^6.11.0
- @types/jsonwebtoken: ^9.0.5
- eslint: ^8.53.0
- eslint-config-prettier: ^9.0.0
- prettier: ^3.1.0
- ts-node-dev: ^2.0.0
- typescript: ^5.2.2

## 1.Installation

Run `npm install` to install project dependencies.

## 2.Environment setup

Create a `.env` file and put your environment variable there. Save the following variable:

NODE_ENV=development
PORT=Your port
DATABASE_URL=Your MongoDB Atlas URL
BCRYPT_SALT_ROUNDS=Your salt round
JWT_ACCESS_SECRET=Your access token
ACCESS_TOKEN_EXPIRATION=Your expiration time

## Usage

Run `npm run dev` to run the project locally.

## Links:

### Api Link : (https://course-review-with-auth-iota.vercel.app/)

### Documentation: (https://documenter.getpostman.com/view/27379505/2s9YsDjZsJ)
